L.GeoJSON.AJAX=L.GeoJSON.extend({defaultAJAXparams:{dataType:"json",callbackParam:"callback",middleware:function(e){return e}},initialize:function(e,t){this._urls=[];if(e){if(typeof e==="string"){this._urls.push(e)}else if(typeof e.pop==="function"){this._urls=this._urls.concat(e)}else{t=e;e=undefined}}var a=L.Util.extend({},this.defaultAJAXparams);for(var s in t){if(this.defaultAJAXparams.hasOwnProperty(s)){a[s]=t[s]}}this.ajaxParams=a;this._layers={};L.Util.setOptions(this,t);if(this._urls.length>0){this.addUrl(this._urls)}},addUrl:function(e){var t=this;if(typeof e==="string"){t._urls.push(e)}else if(typeof e.pop==="function"){t._urls=t._urls.concat(e)}var t=this;var a=t._urls.length;var s=0;t.fire("beforeDataLoad");while(s<a){if(t.ajaxParams.dataType.toLowerCase()==="json"){L.Util.ajax(t._urls[s],function(e){var a=t.ajaxParams.middleware(e);t.addData(a);t.fire("dataLoaded")})}else if(t.ajaxParams.dataType.toLowerCase()==="jsonp"){L.Util.jsonp(t._urls[s],function(e){var a=t.ajaxParams.middleware(e);t.addData(a);t.fire("dataLoaded")},t.ajaxParams.callbackParam)}s++}t.fire("dataLoadComplete")},refresh:function(e){e=e||this._urls;this.clearLayers();this.addUrl(e)},refilter:function(e){if(typeof e!=="function"){this.eachLayer(function(e){e.setStyle({stroke:true,clickable:true})})}else{this.eachLayer(function(t){if(e(t.feature)){t.setStyle({stroke:true,clickable:true})}else{t.setStyle({stroke:false,clickable:false})}})}}});L.geoJson.ajax=function(e,t){return new L.GeoJSON.AJAX(e,t)};L.Util.ajax=function(url,cb){if(window.XMLHttpRequest===undefined){window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP.6.0")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP.3.0")}catch(t){throw new Error("XMLHttpRequest is not supported")}}}}var response,request=new XMLHttpRequest;request.open("GET",url);request.onreadystatechange=function(){if(request.readyState===4&&request.status===200){if(window.JSON){response=JSON.parse(request.responseText)}else{response=eval("("+request.responseText+")")}cb(response)}};request.send()};L.Util.jsonp=function(e,t,a,s){var r,i,n,o,l=document.getElementsByTagName("head")[0];var a=a||"callback";if(s){r=s}else{n="_"+(""+Math.random()).slice(2);r="L.Util.jsonp.cb."+n}o=L.DomUtil.create("script","",l);o.type="text/javascript";if(n){L.Util.jsonp.cb[n]=function(e){l.removeChild(o);delete L.Util.jsonp.cb[n];t(e)}}if(e.indexOf("?")===-1){i=e+"?"+a+"="+r}else{i=e+"&"+a+"="+r}o.src=i};L.Util.jsonp.cb={};